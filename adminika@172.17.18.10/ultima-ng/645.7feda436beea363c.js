"use strict";(self.webpackChunkultima_ng=self.webpackChunkultima_ng||[]).push([[645],{7744:(y,g,i)=>{i.d(g,{T:()=>_});var h=i(9212),s=i(9862);let _=(()=>{class c{constructor(p){this.http=p}getCountries(){return this.http.get("assets/demo/data/countries.json").toPromise().then(p=>p.data).then(p=>p)}getNationalite(){return this.http.get("assets/demo/data/nationalites.json").toPromise().then(p=>p.data).then(p=>p)}static#e=this.\u0275fac=function(d){return new(d||c)(h.LFG(s.eN))};static#t=this.\u0275prov=h.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},7645:(y,g,i)=>{i.r(g),i.d(g,{VilleComponent:()=>j});var h=i(6814),s=i(95),_=i(5219),c=i(707),E=i(3714),p=i(4480),d=i(9232),C=i(4104),b=i(6340),O=i(3173),A=i(1712),T=i(7213),M=i(3904),P=i(3259),U=i(8645),D=i(9773),v=i(4221),f=i(485),Z=i(8433),m=i(9075),V=i(7703),e=i(9212),B=i(7744),x=i(3965);function L(n,u){if(1&n){const t=e.EpF();e.TgZ(0,"div",23)(1,"div")(2,"button",24),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addVille())}),e.qZA()(),e._UZ(3,"h5",25),e.TgZ(4,"span",26),e._UZ(5,"i",27),e.TgZ(6,"input",28,29),e.NdJ("input",function(o){e.CHM(t);const a=e.oxw(),r=e.MAs(5);return e.KtG(a.onGlobalFilter(r,o))}),e.qZA()()()}}function R(n,u){1&n&&(e.TgZ(0,"tr")(1,"th",30),e._uU(2,"Localit\xe9 "),e._UZ(3,"p-columnFilter",31),e.qZA(),e.TgZ(4,"th",30),e._uU(5,"Pays "),e._UZ(6,"p-columnFilter",32),e.qZA(),e.TgZ(7,"th",30),e._uU(8,"Action"),e.qZA()())}function I(n,u){if(1&n){const t=e.EpF();e.TgZ(0,"tr",33)(1,"td",34),e._uU(2),e.qZA(),e.TgZ(3,"td",34),e._uU(4),e.qZA(),e.TgZ(5,"td",35)(6,"button",36),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.update(a))}),e.qZA(),e.TgZ(7,"button",37),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.deleteVille(a))}),e.qZA()()()}if(2&n){const t=u.$implicit;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(t.nom),e.xp6(2),e.Oqu(t.pays||"N/A")}}function F(n,u){1&n&&(e.TgZ(0,"tr")(1,"td",38)(2,"span",39),e._uU(3,"Aucune localit\xe9 trouv\xe9e !"),e.qZA()()())}function K(n,u){if(1&n&&(e.TgZ(0,"div",40),e._UZ(1,"img",41),e.TgZ(2,"span",42),e._uU(3),e.qZA()()),2&n){const t=u.$implicit;e.xp6(1),e.Tol("flag flag-"+t.code.toLowerCase()),e.xp6(2),e.Oqu(t.name)}}const S=()=>[10,20,30],W=()=>["nom","pays"],w=()=>({width:"700px",maxHeight:"90vh"}),N=()=>({width:"100%"}),J=()=>({standalone:!0}),G=()=>({marginTop:"80px"});let j=(()=>{class n{constructor(t,l,o,a,r){this.fb=t,this.store=l,this.messageService=o,this.countryService=a,this.confirmationService=r,this.countries=[],this.destroy$=new U.x,this.villes=[],this.ville={},this.cols=[],this.selectedVille={},this.keyword="",this.enableFilter=!1,this.totalItems=0,this.itemsPerPage=10,this.page=0,this.first=0,this.rows=5,this.villeDialog=!1,this.loading=!0,this.isUpdate=!1,this.items=[],this.popupHeader="Enregistrer une Ville"}ngOnInit(){this.countryService.getCountries().then(t=>{this.countries=t}),this.cols=[{field:"nom",header:"Nom"},{field:"pays",header:"Pays"}],this.createFormSearch(),this.createFormVille(),this.villeList$=this.store.pipe((0,v.Ys)(Z.V)),this.store.dispatch(m.zm()),this.villeList$.pipe((0,D.R)(this.destroy$)).subscribe(t=>{console.log("=== Donn\xe9es re\xe7ues du store ===",t),t&&(this.loading=!1,this.villes=[...t])}),this.store.pipe((0,v.Ys)(V.i),(0,D.R)(this.destroy$)).subscribe(t=>{t&&t.message&&(this.showToast(t.status,t.message),t.status===f.sB.success&&this.store.dispatch(m.zm()))})}showToast(t,l){switch(this.messageService.clear(),t){case f.sB.success:this.messageService.add({severity:"success",summary:"Succ\xe8s",detail:l,life:3e3});break;case f.sB.error:this.messageService.add({severity:"error",summary:"Erreur",detail:l,life:5e3});break;case f.sB.warning:this.messageService.add({severity:"warn",summary:"Attention",detail:l,life:4e3})}}onEnableFilter(){this.enableFilter=!this.enableFilter}onRowSelect(t){console.log(t.data)}createFormSearch(){this.formSearch=this.fb.group({keyword:[null]})}createFormVille(){this.villeFormGroup=this.fb.group({id:this.fb.control("",[]),nom:this.fb.control("",[s.kI.required,s.kI.minLength(2)])})}findPays(t){t&&t.name&&(this.ville.pays=t.name)}handleActionsClick(t){this.selectedVille=t}onPageChange(t){this.first=t.first,this.page=t.page,this.itemsPerPage=t.rows,this.rows=t.rows}onResetForm(){this.formSearch.reset()}openNew(){this.villeDialog=!0}addVille(){this.ville={},this.villeDialog=!0}update(t){this.popupHeader="Modifier une Ville",this.selectedCountry=t.pays?this.countries.find(l=>l.name===t.pays):null,this.villeFormGroup.patchValue({id:t.id,nom:t.nom}),this.ville={...t},this.villeDialog=!0,this.isUpdate=!0}onSave(){const t=this.villeFormGroup.value,l={id:t.id,nom:t.nom,pays:this.ville.pays};this.isUpdate&&t.id&&(l.id=t.id),console.log("Final object to save:",l),console.log("Has ID?",!!l.id),console.log("===============Ville \xe0 sauvegarder=====================",l),this.confirmationService.confirm({message:"\xcates-vous s\xfbr de vouloir ajouter cette ville?",header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>{this.store.dispatch(this.isUpdate&&l.id?m.ti({ville:l}):m.CV(l)),this.villeFormGroup.reset(),this.selectedCountry=null,this.ville={},this.villeDialog=!1,this.isUpdate=!1}})}deleteVille(t){this.confirmationService.confirm({message:"\xcates-vous s\xfbr de vouloir supprimer cette ville?",header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>{console.log("Ville \xe0 supprimer:",t),t.id&&this.store.dispatch(m.oK(t))}})}onGlobalFilter(t,l){t.filterGlobal(l.target.value,"contains")}cancel(){this.villeFormGroup.reset(),this.selectedCountry=null,this.ville={},this.villeDialog=!1,this.isUpdate=!1,this.popupHeader="Enregistrer une Ville"}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}static#e=this.\u0275fac=function(l){return new(l||n)(e.Y36(s.qu),e.Y36(v.yh),e.Y36(_.ez),e.Y36(B.T),e.Y36(_.YP))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-Ville"]],standalone:!0,features:[e._Bn([_.ez,_.YP]),e.jDz],decls:31,vars:32,consts:[[1,"grid"],[1,"text-3xl","font-semibold","text-gray-800"],[1,"col-12","md:col-12"],["styleClass","p-datatable-gridlines p-datatable-sm p-datatable","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","id",3,"value","columns","rows","paginator","rowsPerPageOptions","showCurrentPageReport","globalFilterFields","selection","rowHover","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"visible","modal","closable","header","visibleChange"],[3,"formGroup","ngSubmit"],[1,"p-fluid"],[1,"field"],["for","nom"],[1,"required",2,"color","red !important"],["id","nom","type","text","pInputText","","formControlName","nom","placeholder","Ex: Ouagadougou"],["for","pays"],["id","pays","filterBy","name","placeholder","S\xe9lectionnez un pays","optionLabel","name","display","chip","appendTo","body",3,"options","ngModelOptions","ngModel","showClear","filter","ngModelChange","onChange"],["pTemplate","item"],[1,"flex","justify-content-end","gap-2","mt-3"],["pButton","","label","Annuler","icon","pi pi-times","type","button",1,"p-button-secondary",3,"click"],["pButton","","label","Enregistrer","icon","pi pi-check","type","submit",1,"p-button-success",3,"disabled"],["position","top-center"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","label","Nouvelle localit\xe9","icon","pi pi-plus",1,"p-button-success","mr-2","mb-2",3,"click"],[1,"p-button-outlined","mb-2"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Rechercher",1,"w-full",3,"input"],["filter",""],[2,"font-weight","bold"],["type","text","display","menu","field","nom"],["type","text","display","menu","field","pays"],[3,"pSelectableRow"],[1,"table-separator"],[1,"text-right"],["pButton","","icon","pi pi-pencil","pTooltip","Modifier",1,"p-button-rounded","p-button-info","mr-2",3,"click"],["pButton","","icon","pi pi-trash","pTooltip","Supprimer",1,"p-button-rounded","p-button-danger",3,"click"],["colspan","3",2,"text-align","center","font-size","1.2em","color","red","font-weight","bold"],[1,"text-danger"],[1,"flex","align-items-center"],["src","assets/demo/images/flag/flag_placeholder.png",2,"width","21px"],[1,"ml-2"]],template:function(l,o){1&l&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2,"Gestion des Localit\xe9s"),e.qZA(),e.TgZ(3,"div",2)(4,"p-table",3,4),e.NdJ("selectionChange",function(r){return o.selectedVille=r}),e.YNc(6,L,8,0,"ng-template",5)(7,R,9,0,"ng-template",6)(8,I,8,3,"ng-template",7)(9,F,4,0,"ng-template",8),e.qZA()(),e.TgZ(10,"p-dialog",9),e.NdJ("visibleChange",function(r){return o.villeDialog=r}),e.TgZ(11,"form",10),e.NdJ("ngSubmit",function(){return o.onSave()}),e.TgZ(12,"div",11)(13,"div",12)(14,"label",13),e._uU(15,"Ville "),e.TgZ(16,"span",14),e._uU(17,"*"),e.qZA()(),e._UZ(18,"input",15),e.qZA(),e.TgZ(19,"div",12)(20,"label",16),e._uU(21,"Pays "),e.TgZ(22,"span",14),e._uU(23,"*"),e.qZA()(),e.TgZ(24,"p-dropdown",17),e.NdJ("ngModelChange",function(r){return o.selectedCountry=r})("onChange",function(){return o.findPays(o.selectedCountry)}),e.YNc(25,K,4,3,"ng-template",18),e.qZA()()(),e.TgZ(26,"div",19)(27,"button",20),e.NdJ("click",function(){return o.cancel()}),e.qZA(),e._UZ(28,"button",21),e.qZA()()(),e._UZ(29,"p-toast",22)(30,"p-confirmDialog"),e.qZA()),2&l&&(e.xp6(4),e.Q6J("value",o.villes)("columns",o.cols)("rows",5)("paginator",!0)("rowsPerPageOptions",e.DdM(26,S))("showCurrentPageReport",!0)("globalFilterFields",e.DdM(27,W))("selection",o.selectedVille)("rowHover",!0),e.xp6(6),e.Akn(e.DdM(28,w)),e.Q6J("visible",o.villeDialog)("modal",!0)("closable",!1)("header",o.popupHeader),e.xp6(1),e.Q6J("formGroup",o.villeFormGroup),e.xp6(13),e.Akn(e.DdM(29,N)),e.Q6J("options",o.countries)("ngModelOptions",e.DdM(30,J))("ngModel",o.selectedCountry)("showClear",!0)("filter",!0),e.xp6(4),e.Q6J("disabled",o.villeFormGroup.invalid||!o.selectedCountry),e.xp6(1),e.Akn(e.DdM(31,G)))},dependencies:[h.ez,d.U$,d.iA,_.jx,d.Ei,d.xl,s.u5,s._Y,s.Fj,s.JJ,s.JL,s.On,c.hJ,c.Hq,p.T,P.z,P.u,b.V,C.EV,C.FN,E.j,E.o,s.UX,s.sg,s.u,O.l,A.U,x.Lt,T.S,T.V,M.D,M.Q]})}return n})()}}]);